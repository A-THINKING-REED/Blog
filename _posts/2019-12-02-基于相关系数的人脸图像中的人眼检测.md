---
layout: post
title: 基于相关系数的人脸图像中的人眼检测
date: 2019-10-22
Author: Lee-Coderr
categories:
- 数字图像处理
tags: [数字图像处理,人眼检测]
comments: true
pinned: true
---



# 原理

两个矩阵 $A,B$ 的相关性可用下面式子表示。
$$
r=\frac{\sum_{m} \sum_{n}(A_{m n}-\bar{A})(B_{m n}-\bar{B})}{\sqrt{\left(\sum_{m} \sum_{n}(A_{m n}-\bar{A})^{2}\right)\left(\sum_{m} \sum_{n}(B_{m n}-\bar{B})^{2}\right.})}
$$
上述式子可以用 $matlab$ 中的 $corr2(A,B)$ 函数实现。

# 代码

```matlab
clear all;
close all;

left_eye = imread('./img/lefteye.tif');
right_eye = imread('./img/righteye.tif');

for i=1:12
    f = imread(['./img/test', num2str(i), '.jpg']);
    f = rgb2gray(f);
    f = Identify_eye(f,left_eye,right_eye);
    figure(i); imshow(f);
end
function [out] = Identify_eye(f, t, t2)
    f = imresize(f,[200,150]);
    [M,N] = size(f); [J,K] = size(t); [J2,K2] = size(t2);
    [x,y] = Location(f,t);
    img = Draw_Eye_L(f, x, y, J, K);
    [x2,y2] = Location(f,t2);
    img = Draw_Eye_L(img, x2, y2, J2, K2);
    out = img;
end
function [x,y] = Location(f,t)
    [M,N] = size(f); [J,K] = size(t);
    R = zeros(M-J+1,N-K+1);
    v0 = sum(sum(t.*t));
    for x=1:M-J+1
        for y=1:N-K+1
            R(x,y) = corr2(f(x:x+J-1,y:y+K-1),t);
        end
    end
    [x,y] = find(R == max(max(R)), 1);
end
function [out] = Draw_Eye_L(a, x, y, M, N)
    x1 = x+M-1;
    y1 = y+N-1;
    for i=x:x1
        a(i,y)=255;
        a(i,y1)=255;
    end
    for i=y:y1
        a(x,i)=255;
        a(x1,i)=255;
    end
    out = a;
end
```



